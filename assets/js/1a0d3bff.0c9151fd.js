"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[630],{5628:(s,e,n)=>{n.r(e),n.d(e,{assets:()=>r,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>m,toc:()=>c});var a=n(4848),t=n(8453);const i={title:"Building Custom Optimizers",sidebar_position:9},l="Building Custom Optimizers",m={id:"building_custom_optimizer",title:"Building Custom Optimizers",description:"Here we look at the steepest descent algorithm for unconstrained problems.",source:"@site/docs/building_custom_optimizer.mdx",sourceDirName:".",slug:"/building_custom_optimizer",permalink:"/modopt/docs/building_custom_optimizer",draft:!1,unlisted:!1,editUrl:"https://github.com/lsdolab/modopt/edit/main/website/docs/building_custom_optimizer.mdx",tags:[],version:"current",sidebarPosition:9,frontMatter:{title:"Building Custom Optimizers",sidebar_position:9},sidebar:"tutorialSidebar",previous:{title:"SNOPT",permalink:"/modopt/docs/optimizers_available/SNOPT"}},r={},c=[];function h(s){const e={annotation:"annotation",code:"code",h1:"h1",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",mspace:"mspace",msub:"msub",msup:"msup",mtext:"mtext",munder:"munder",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",...(0,t.R)(),...s.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.h1,{id:"building-custom-optimizers",children:"Building Custom Optimizers"}),"\n",(0,a.jsxs)(e.p,{children:["Here we look at the ",(0,a.jsx)(e.strong,{children:"steepest descent"})," algorithm for unconstrained problems."]}),"\n",(0,a.jsx)(e.p,{children:"For a general unconstrained optimization problem stated as:"}),"\n",(0,a.jsx)(e.span,{className:"katex-display",children:(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:(0,a.jsx)(e.mtext,{children:"minimize"})}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:"x"}),(0,a.jsx)(e.mo,{children:"\u2208"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{mathvariant:"double-struck",children:"R"}),(0,a.jsx)(e.mi,{mathvariant:"double-struck",children:"n"})]})]})]})}),(0,a.jsx)(e.mspace,{width:"1em"}),(0,a.jsx)(e.mi,{children:"f"}),(0,a.jsx)(e.mo,{stretchy:"false",children:"("}),(0,a.jsx)(e.mi,{children:"x"}),(0,a.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\underset{x \\in \\mathbb{R^n}}{\\text{minimize}} \\quad f(x)"})]})})}),(0,a.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"1.5256em",verticalAlign:"-0.7756em"}}),(0,a.jsx)(e.span,{className:"mord",children:(0,a.jsx)(e.span,{className:"mop op-limits",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsxs)(e.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,a.jsxs)(e.span,{style:{top:"-2.3518em",marginLeft:"0em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"x"}),(0,a.jsx)(e.span,{className:"mrel mtight",children:"\u2208"}),(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mathbb mtight",children:"R"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsx)(e.span,{className:"vlist-t",children:(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.5935em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.786em",marginRight:"0.0714em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"n"})})]})})})})})]})]})})]}),(0,a.jsxs)(e.span,{style:{top:"-3em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:"mop",children:(0,a.jsx)(e.span,{className:"mord text",children:(0,a.jsx)(e.span,{className:"mord",children:"minimize"})})})})]})]}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.7756em"},children:(0,a.jsx)(e.span,{})})})]})})}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"1em"}}),(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,a.jsx)(e.span,{className:"mopen",children:"("}),(0,a.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,a.jsx)(e.span,{className:"mclose",children:")"})]})})]})}),"\n",(0,a.jsx)(e.p,{children:"the steepest descent algorithms computes the new iterate recursively by using the formula"}),"\n",(0,a.jsx)(e.span,{className:"katex-display",children:(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"x"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:"k"}),(0,a.jsx)(e.mo,{children:"+"}),(0,a.jsx)(e.mn,{children:"1"})]})]}),(0,a.jsx)(e.mo,{children:"="}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"x"}),(0,a.jsx)(e.mi,{children:"k"})]}),(0,a.jsx)(e.mo,{children:"\u2212"}),(0,a.jsx)(e.mi,{mathvariant:"normal",children:"\u2207"}),(0,a.jsx)(e.mi,{children:"f"}),(0,a.jsx)(e.mo,{stretchy:"false",children:"("}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"x"}),(0,a.jsx)(e.mi,{children:"k"})]}),(0,a.jsx)(e.mo,{stretchy:"false",children:")"}),(0,a.jsx)(e.mi,{mathvariant:"normal",children:"."})]}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"x_{k+1} = x_{k} - \\nabla f(x_k) ."})]})})}),(0,a.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.6389em",verticalAlign:"-0.2083em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03148em"},children:"k"}),(0,a.jsx)(e.span,{className:"mbin mtight",children:"+"}),(0,a.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2083em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(e.span,{className:"mrel",children:"="}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.7333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03148em"},children:"k"})})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,a.jsx)(e.span,{className:"mord",children:"\u2207"}),(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,a.jsx)(e.span,{className:"mopen",children:"("}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03148em"},children:"k"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mclose",children:")"}),(0,a.jsx)(e.span,{className:"mord",children:"."})]})]})]})}),"\n",(0,a.jsxs)(e.p,{children:["Given an initial guess ",(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"x"}),(0,a.jsx)(e.mn,{children:"0"})]})}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"x_0"})]})})}),(0,a.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mtight",children:"0"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]}),", we can write an optimizer using the steepest descent algorithm using the ",(0,a.jsx)(e.strong,{children:"Optimizer()"})," class in modOpt as follows:"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-py",children:"import numpy as np\nimport time\n\nfrom modopt import Optimizer\n\n\nclass SteepestDescent(Optimizer):\n    def initialize(self):\n        # Name your algorithm\n        self.solver = 'steepest_descent'\n\n        self.obj = self.problem.compute_objective\n        self.grad = self.problem.compute_objective_gradient\n\n        self.options.declare('opt_tol', types=float)\n        # self.declare_outputs(x=2, f=1, opt=1, time=1)\n\n    def solve(self):\n        nx = self.problem.nx\n        x0 = x0 = self.problem.x.get_data()\n        opt_tol = self.options['opt_tol']\n        max_itr = self.options['max_itr']\n\n        obj = self.obj\n        grad = self.grad\n\n        start_time = time.time()\n\n        # Setting intial values for current iterates\n        x_k = x0 * 1.\n        f_k = obj(x_k)\n        g_k = grad(x_k)\n\n        itr = 0\n\n        opt = np.linalg.norm(g_k)\n\n        # Initializing outputs\n        self.update_outputs(itr=0,\n                            x=x0,\n                            obj=f_k,\n                            opt=opt,\n                            time=time.time() - start_time)\n\n        while (opt > opt_tol and itr < max_itr):\n            itr_start = time.time()\n            itr += 1\n\n            p_k = -g_k\n            x_k += p_k\n            f_k = obj(x_k)\n            g_k = grad(x_k)\n\n            opt = np.linalg.norm(g_k)\n\n            # Append outputs dict with new values from the current iteration\n            self.update_outputs(itr=itr,\n                                x=x_k,\n                                obj=f_k,\n                                opt=opt,\n                                time=time.time() - itr_start)\n\n        end_time = time.time()\n        self.total_time = end_time - start_time\n"})}),"\n",(0,a.jsxs)(e.p,{children:["The ",(0,a.jsx)(e.strong,{children:"Optimizer()"})," class records all the data needed using the ",(0,a.jsx)(e.code,{children:"outputs"})," dictionary."]})]})}function d(s={}){const{wrapper:e}={...(0,t.R)(),...s.components};return e?(0,a.jsx)(e,{...s,children:(0,a.jsx)(h,{...s})}):h(s)}},8453:(s,e,n)=>{n.d(e,{R:()=>l,x:()=>m});var a=n(6540);const t={},i=a.createContext(t);function l(s){const e=a.useContext(i);return a.useMemo((function(){return"function"==typeof s?s(e):{...e,...s}}),[e,s])}function m(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(t):s.components||t:l(s.components),a.createElement(i.Provider,{value:e},s.children)}}}]);